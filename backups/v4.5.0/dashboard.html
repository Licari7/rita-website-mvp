<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Área de Membros | Floresce Terapias</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Montserrat:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.2/tinymce.min.js" referrerpolicy="origin"></script>
    <style>
        /* Hide API Key Warning - Minimal & Safe */
        .tox-notifications-container,
        .tox-statusbar__branding,
        .tox-promotion {
            display: none !important;
        }

        /* Accordion Styles */
        details.admin-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }

        details.admin-card[open] {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        details.admin-card.dragging {
            opacity: 0.5;
            border: 2px dashed #ccc;
        }

        summary.admin-card-header {
            padding: 20px;
            cursor: move;
            /* Indicate draggable */
            font-weight: 600;
            font-family: var(--font-serif);
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            list-style: none;
            /* Hide default triangle */
            color: var(--color-primary);
            background: #fff;
            user-select: none;
        }

        summary.admin-card-header:hover {
            background: #fcfcfc;
        }

        summary.admin-card-header::after {
            content: '+';
            font-size: 1.5em;
            font-weight: 300;
            color: #999;
            transition: transform 0.2s;
        }

        details.admin-card[open] summary.admin-card-header::after {
            content: '-';
            transform: rotate(0deg);
        }

        /* Hide default marker in Webkit */
        summary.admin-card-header::-webkit-details-marker {
            display: none;
        }

        .admin-card-body {
            padding: 25px;
            border-top: 1px solid #eee;
            background: #fafafa;
            animation: slideDown 0.3s ease-out;
            cursor: default !important;
            /* Reset cursor in body */
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-content">
            <div class="brand-container">
                <a href="index.html" class="logo">Floresce Terapias</a>
            </div>

            <ul class="nav-links">
                <li><a href="index.html">Início</a></li>
                <li><a href="index.html#about">Sobre</a></li>
                <li><a href="index.html#services">Serviços</a></li>
                <li><a href="index.html#events">Eventos</a></li>
                <li><a href="booking.html">Agenda</a></li>
                <li><a href="dashboard.html" class="active">Área de Membros</a></li>
            </ul>

            <div class="nav-actions">
                <span id="user-name-display" class="desktop-only"
                    style="margin-right: 15px; font-weight: 500;">Visitante</span>
                <a href="#" id="logout-btn" class="btn btn-outline btn-sm">Sair</a>
            </div>

            <button class="menu-toggle" aria-label="Menu">
                <i data-lucide="menu"></i>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu">
        <button class="close-menu"><i data-lucide="x"></i></button>
        <span style="display: block; margin-bottom: 20px; font-weight: 600; color: var(--color-primary);">Olá, <span
                id="mobile-user-name">Visitante</span></span>

        <ul class="mobile-links-list" style="list-style: none; padding: 0;">
            <li><a href="index.html" style="display: block; padding: 10px 0; color: var(--color-bg);">Início</a>
            </li>
            <li><a href="index.html#about" style="display: block; padding: 10px 0; color: var(--color-bg);">Sobre</a>
            </li>
            <li><a href="index.html#services"
                    style="display: block; padding: 10px 0; color: var(--color-bg);">Serviços</a></li>
            <li><a href="index.html#events" style="display: block; padding: 10px 0; color: var(--color-bg);">Eventos</a>
            </li>
            <li><a href="booking.html" style="display: block; padding: 10px 0; color: var(--color-bg);">Agenda</a></li>
            <li><a href="dashboard.html"
                    style="display: block; padding: 10px 0; color: var(--color-primary); font-weight: 600;">Área de
                    Membros</a></li>
        </ul>

        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">

        <a href="#" id="mobile-logout-btn" style="color: #e57373;">Sair da Conta</a>
    </div>

    <!-- Main Content -->
    <main class="container section-padding">
        <header class="section-header text-center" style="margin-bottom: 40px;">
            <h1 class="section-title">Área de Membros</h1>
            <p>Acede aqui aos teus recursos e meditações.</p>
            <button id="admin-toggle-btn" class="cta-button"
                style="display: none; margin: 20px auto 0; background-color: #333; color: white;">
                <i data-lucide="settings"></i> Gerir Site
            </button>
        </header>

        <!-- ADMIN PANEL (Hidden by Default) -->
        <section id="admin-panel" style="display: none; max-width: 900px; margin: 0 auto 60px;">
            <h2 style="color: var(--color-primary); margin-bottom: 30px; text-align: center;">
                Painel de Administração
            </h2>

            <div id="dashboard-cards-container">
                <!-- 1. EVENTS ACCORDION -->
                <details class="admin-card draggable-card" id="card-events" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="calendar" style="margin-right: 10px; width: 18px;"></i> Gestão de
                            Eventos</span>
                    </summary>
                    <div class="admin-card-body">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                            <!-- Add Event Form -->
                            <div>
                                <h3 style="font-family: var(--font-serif); margin-bottom: 15px;">Adicionar Novo Evento
                                </h3>
                                <form id="event-form" class="auth-form">
                                    <input type="hidden" id="evt-id">
                                    <div class="form-group">
                                        <label>Título do Evento</label>
                                        <input type="text" id="evt-title" required placeholder="Ex: Workshop de Aura">
                                    </div>
                                    <div class="form-group-row" style="display: flex; gap: 10px;">
                                        <div class="form-group" style="flex: 1;">
                                            <label>Data</label>
                                            <input type="date" id="evt-date" required>
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label>Hora</label>
                                            <input type="time" id="evt-time" required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Localização (Ex: Online Zoom)</label>
                                        <input type="text" id="evt-location" required
                                            placeholder="Ex: Lisboa ou Online">
                                    </div>
                                    <div class="form-group">
                                        <label>Descrição Curta</label>
                                        <textarea id="evt-desc" rows="3" placeholder="Descrição breve para o site"
                                            style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 8px;"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label>Imagem (Capa)</label>
                                        <input type="file" id="evt-image" accept="image/*">
                                    </div>
                                    <div class="form-group">
                                        <label>Link de Inscrição (Opcional)</label>
                                        <input type="text" id="evt-link" placeholder="#contact ou link externo">
                                    </div>
                                    <button type="submit" class="cta-button primary full-width">Publicar Evento</button>
                                </form>
                            </div>

                            <!-- Existing Events List -->
                            <div style="border-left: 1px solid #eee; padding-left: 40px;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <h3 style="font-family: var(--font-serif); margin: 0;">Eventos Ativos</h3>
                                    <button type="button" onclick="window.resetEventForm()"
                                        class="btn btn-outline btn-sm" style="font-size: 0.8rem;">+ Novo</button>
                                </div>
                                <div id="admin-events-list">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- 2. HOME HERO ACCORDION -->
                <details class="admin-card draggable-card" id="card-home-hero" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="home" style="margin-right: 10px; width: 18px;"></i> Página Inicial
                            (Hero)</span>
                    </summary>
                    <div class="admin-card-body">
                        <form id="home-content-form" class="auth-form">
                            <div class="form-group">
                                <label>Título Principal</label>
                                <input type="text" id="home-title" placeholder="Encontra espaço em ti...">
                            </div>
                            <div class="form-group">
                                <label>Subtítulo</label>
                                <input type="text" id="home-subtitle" placeholder="Leitura de Aura...">
                            </div>
                            <div class="form-group">
                                <input type="text" id="home-cta" placeholder="Descobrir Mais">
                            </div>

                            <!-- Readability Controls -->
                            <div class="form-group-row"
                                style="display: flex; gap: 20px; align-items: center; margin-bottom: 15px; background: whitesmoke; padding: 10px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <label for="home-text-color" style="margin:0;">Cor do Texto:</label>
                                    <input type="color" id="home-text-color" value="#E1D7CE"
                                        style="width: 50px; height: 30px; border: none; cursor: pointer;">
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="home-text-highlight"
                                        style="width: 18px; height: 18px; margin:0;">
                                    <label for="home-text-highlight" style="margin:0; cursor: pointer;">Fundo de
                                        Destaque?</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Imagem de Fundo (Opcional)</label>
                                <input type="text" id="home-image-url" placeholder="URL da imagem (ou upload abaixo)"
                                    style="margin-bottom:5px; background:whitesmoke; border:1px solid #ddd; width:100%; padding:10px; border-radius:8px; display:none;">
                                <input type="file" id="home-image-file" accept="image/*">
                                <small style="color: #666;">Substitui a cor verde por uma foto.</small>
                            </div>
                            <button type="submit" id="home-save-btn" class="cta-button primary full-width">Guardar
                                Início</button>
                        </form>
                    </div>
                </details>

                <!-- 3. HOME SUMMARY ACCORDION (New) -->
                <details class="admin-card draggable-card" id="card-home-summary" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="align-left" style="margin-right: 10px; width: 18px;"></i> Página Inicial
                            (Resumo Sobre)</span>
                    </summary>
                    <div class="admin-card-body">
                        <form id="home-about-form" class="auth-form">
                            <div class="form-group">
                                <label>Título (Ex: Uma jornada de luz)</label>
                                <input type="text" id="home-about-title-input" placeholder="Título do resumo">
                            </div>
                            <div class="form-group">
                                <label>Texto do Resumo</label>
                                <textarea id="home-about-text-input" rows="4"
                                    placeholder="Breve texto introdutório que aparece na página inicial..."
                                    style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 8px;"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Imagem Lateral (Pequena)</label>
                                <input type="text" id="home-about-image-url" style="display:none;">
                                <input type="file" id="home-about-image-file" accept="image/*">
                            </div>
                            <button type="submit" id="home-about-save-btn" class="cta-button primary full-width">Guardar
                                Resumo</button>
                        </form>
                    </div>
                </details>

                <!-- 4. ABOUT PAGE FULL ACCORDION -->
                <details class="admin-card draggable-card" id="card-about-full" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="user" style="margin-right: 10px; width: 18px;"></i> Página "Sobre Mim"
                            (Completa)</span>
                    </summary>
                    <div class="admin-card-body">
                        <form id="about-content-form" class="auth-form">
                            <div class="form-group">
                                <label>Título da Página</label>
                                <input type="text" id="about-title" placeholder="Uma jornada de luz">
                            </div>
                            <div class="form-group">
                                <label>Foto de Perfil (Topo)</label>
                                <input type="text" id="about-image-url" style="display:none;">
                                <input type="file" id="about-image-file" accept="image/*">
                            </div>
                            <div class="form-group">
                                <label>Biografia Completa</label>
                                <textarea id="about-text" rows="10" placeholder="A tua história completa..."
                                    style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 8px;"></textarea>
                                <small style="color: #666;">Aceita HTML básico.</small>
                            </div>
                            <button type="submit" id="about-save-btn" class="cta-button primary full-width">Guardar
                                Página Sobre</button>
                        </form>
                    </div>
                </details>

                <!-- 5. SERVICES ACCORDION -->
                <details class="admin-card draggable-card" id="card-services" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="sparkles" style="margin-right: 10px; width: 18px;"></i> Gestão de
                            Serviços</span>
                    </summary>
                    <div class="admin-card-body">
                        <div class="admin-panel-content" id="panel-services">
                            <form id="service-form" class="auth-form" style="max-width: 100%;">
                                <input type="hidden" id="svc-id">

                                <!-- TOP SECTION: List & Metadata -->
                                <div
                                    style="display: grid; grid-template-columns: 350px 1fr; gap: 30px; align-items: start;">

                                    <!-- LEFT: List -->
                                    <div
                                        style="background: #f9f9f9; padding: 15px; border-radius: 12px; border: 1px solid #eee;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                            <h3 style="font-family: var(--font-serif); margin: 0;">Serviços Ativos</h3>
                                            <button type="button" onclick="window.resetServiceForm()"
                                                class="btn btn-outline btn-sm" style="font-size: 0.8rem;">+
                                                Novo</button>
                                        </div>
                                        <div id="admin-services-list" style="max-height: 400px; overflow-y: auto;">
                                            <!-- Populated by JS -->
                                        </div>
                                    </div>

                                    <!-- RIGHT: Basic Inputs -->
                                    <div>
                                        <h3
                                            style="font-family: var(--font-serif); margin-bottom: 15px; display:flex; justify-content:space-between; align-items:center;">
                                            Dados do Serviço
                                            <button type="button"
                                                onclick="if(window.initTinyMCE) window.initTinyMCE('', true); else if(initTinyMCE) initTinyMCE('', true);"
                                                class="btn btn-sm btn-outline"
                                                style="font-size: 0.7rem; padding: 2px 8px;">
                                                Reset Editor
                                            </button>
                                        </h3>

                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                            <div class="form-group" style="grid-column: 1 / -1;">
                                                <label>Nome do Serviço</label>
                                                <input type="text" id="svc-title" required
                                                    placeholder="Ex: Leitura de Aura">
                                            </div>

                                            <div class="form-group" style="grid-column: 1 / -1;">
                                                <label>Descrição Curta (Cartão)</label>
                                                <textarea id="svc-desc" rows="3" required
                                                    placeholder="Resumo breve para o cartão..."
                                                    style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 8px;"></textarea>
                                            </div>

                                            <div class="form-group">
                                                <label>Tema</label>
                                                <select id="svc-theme"
                                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                                                    <option value="">Padrão</option>
                                                    <option value="innerdance">Innerdance</option>
                                                    <option value="constellations">Constelações</option>
                                                    <option value="expansion">Expansão</option>
                                                </select>
                                            </div>

                                            <div class="form-group">
                                                <label>Link (Opcional)</label>
                                                <input type="text" id="svc-link" placeholder="https://...">
                                            </div>

                                            <div class="form-group">
                                                <label>Benefícios (Separar por vírgula)</label>
                                                <input type="text" id="svc-benefits"
                                                    placeholder="Ex: Presencial, Online">
                                            </div>

                                            <div class="form-group">
                                                <label>Imagem de Cabeçalho (URL)</label>
                                                <input type="text" id="svc-image" placeholder="https://..."
                                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                                            </div>
                                        </div>

                                        <div class="form-group" style="margin-top: 10px;">
                                            <label>Ou Upload Imagem</label>
                                            <input type="file" id="svc-image-file" accept="image/*">
                                        </div>
                                    </div>
                                </div>

                                <!-- BOTTOM SECTION: Editor (Full Width) -->
                                <div style="margin-top: 30px;">
                                    <h3 style="font-family: var(--font-serif); margin-bottom: 10px;">Descrição Completa
                                        (Página
                                        Detalhada)</h3>
                                    <div class="form-group">
                                        <textarea id="my-tinymce-editor"></textarea>
                                    </div>
                                </div>

                                <!-- ACTIONS -->
                                <div
                                    style="margin-top: 20px; display: flex; gap: 15px; align-items: center; background: white; padding: 15px; position: sticky; bottom: 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); border-radius: 8px;">
                                    <button type="submit" id="svc-submit-btn" class="cta-button primary"
                                        style="min-width: 200px;">Publicar Serviço</button>
                                    <button type="button" id="svc-cancel-btn" class="btn btn-outline"
                                        style="display: none;" onclick="window.resetServiceForm()">Cancelar
                                        Edição</button>
                                    <div style="flex-grow: 1;"></div>
                                    <button type="button" id="seed-services-btn"
                                        class="btn btn-outline btn-sm">Recuperar
                                        Originais</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </details>

                <!-- 6. TESTIMONIALS ACCORDION -->
                <details class="admin-card draggable-card" id="card-testimonials" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="message-circle" style="margin-right: 10px; width: 18px;"></i> Gestão de
                            Testemunhos</span>
                    </summary>
                    <div class="admin-card-body">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                            <!-- Add Review Form -->
                            <div>
                                <h3 style="font-family: var(--font-serif); margin-bottom: 15px;">Adicionar Novo
                                    Testemunho</h3>
                                <form id="review-form" class="auth-form">
                                    <div class="form-group">
                                        <label>Nome do Cliente</label>
                                        <input type="text" id="rev-name" required placeholder="Ex: Maria Silva">
                                    </div>
                                    <div class="form-group">
                                        <label>Título/Role (Opcional)</label>
                                        <input type="text" id="rev-role" placeholder="Ex: Cliente de Leitura de Aura">
                                    </div>
                                    <div class="form-group">
                                        <label>Mensagem</label>
                                        <textarea id="rev-text" rows="3" required placeholder="O testemunho..."
                                            style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 8px;"></textarea>
                                    </div>
                                    <button type="submit" class="cta-button primary full-width">Publicar
                                        Testemunho</button>
                                </form>
                            </div>

                            <!-- Existing Reviews List -->
                            <div style="border-left: 1px solid #eee; padding-left: 40px;">
                                <h3 style="font-family: var(--font-serif); margin-bottom: 15px;">Testemunhos Ativos</h3>
                                <div id="admin-reviews-list">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- 7. MEDITATIONS ACCORDION -->
                <details class="admin-card draggable-card" id="card-meditations" draggable="true">
                    <summary class="admin-card-header">
                        <span><i data-lucide="headphones" style="margin-right: 10px; width: 18px;"></i> Gestão de
                            Meditações</span>
                    </summary>
                    <div class="admin-card-body">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                            <!-- Add Meditation Form -->
                            <div>
                                <h3 style="font-family: var(--font-serif); margin-bottom: 15px;">Adicionar
                                    Meditação/Recurso</h3>
                                <form id="meditation-form" class="auth-form">
                                    <input type="hidden" id="med-id">
                                    <div class="form-group">
                                        <label>Título</label>
                                        <input type="text" id="med-title" required
                                            placeholder="Ex: Meditação de Enraizamento">
                                    </div>

                                    <div class="form-group">
                                        <label>Tema</label>
                                        <select id="med-theme" required
                                            style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; background: whitesmoke;">
                                            <option value="enraizamento">Enraizamento</option>
                                            <option value="limpeza">Limpeza Energética</option>
                                            <option value="protecao">Proteção</option>
                                            <option value="intuicao">Intuição</option>
                                            <option value="chakras">Chakras</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Tipo de Conteúdo</label>
                                        <select id="med-type" required
                                            style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; background: whitesmoke;">
                                            <option value="audio">Áudio (Link MP3/SoundCloud)</option>
                                            <option value="video">Vídeo (YouTube/Vimeo)</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Link do Recurso (URL ou Iframe)</label>
                                        <input type="text" id="med-url" required
                                            placeholder="https://youtube.com/... ou <iframe...>">
                                        <small style="color: #666;">YouTube, Vimeo ou link direto para ficheiro
                                            áudio.</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Descrição Opcional</label>
                                        <textarea id="med-desc" rows="2" placeholder="Breve descrição..."
                                            style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 8px;"></textarea>
                                    </div>

                                    <div style="display: flex; gap: 10px;">
                                        <button type="submit" id="med-submit-btn"
                                            class="cta-button primary full-width">Publicar
                                            Recurso</button>
                                        <button type="button" id="med-cancel-btn" class="btn btn-outline"
                                            style="display: none;"
                                            onclick="window.resetMeditationForm()">Cancelar</button>
                                    </div>
                                </form>
                            </div>

                            <!-- Existing Meditations List -->
                            <div style="border-left: 1px solid #eee; padding-left: 40px;">
                                <h3 style="font-family: var(--font-serif); margin-bottom: 15px;">Recursos Ativos</h3>
                                <div id="admin-meditations-list">
                                    <!-- Populated by JS -->
                                    <p style="color: #666;">A carregar lista...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </section>

        <!-- Carousel Section -->
        <section class="content-section">
            <h2 class="section-title text-center" style="margin-bottom: 20px; color: var(--color-primary);">As Minhas
                Meditações</h2>

            <div class="carousel-wrapper" style="position: relative;">
                <button class="carousel-nav prev" aria-label="Anterior"><i data-lucide="chevron-left"></i></button>

                <div class="carousel-container">
                    <!-- Card 1: Grounding -->
                    <a href="theme.html#enraizamento" class="carousel-card">
                        <div class="carousel-image" style="background: #e8f5e9;">
                            <i data-lucide="anchor" size="32" color="#2e7d32"></i>
                        </div>
                        <div class="carousel-content">
                            <h3>Enraizamento</h3>
                            <p>Conexão com a Terra e estabilidade.</p>
                        </div>
                    </a>

                    <!-- Card 2: Cleaning -->
                    <a href="theme.html#limpeza" class="carousel-card">
                        <div class="carousel-image" style="background: #e3f2fd;">
                            <i data-lucide="droplets" size="32" color="#1565c0"></i>
                        </div>
                        <div class="carousel-content">
                            <h3>Limpeza Energética</h3>
                            <p>Purificação do campo áurico.</p>
                        </div>
                    </a>

                    <!-- Card 3: Protection -->
                    <a href="theme.html#protecao" class="carousel-card">
                        <div class="carousel-image" style="background: #f3e5f5;">
                            <i data-lucide="shield" size="32" color="#7b1fa2"></i>
                        </div>
                        <div class="carousel-content">
                            <h3>Proteção</h3>
                            <p>Escudos e limites energéticos.</p>
                        </div>
                    </a>

                    <!-- Card 4: Intuition -->
                    <a href="theme.html#intuicao" class="carousel-card">
                        <div class="carousel-image" style="background: #fff3e0;">
                            <i data-lucide="eye" size="32" color="#ef6c00"></i>
                        </div>
                        <div class="carousel-content">
                            <h3>Intuição</h3>
                            <p>Despertar a visão interior.</p>
                        </div>
                    </a>

                    <!-- Card 5: Chakras -->
                    <a href="theme.html#chakras" class="carousel-card">
                        <div class="carousel-image" style="background: #e1bee7;">
                            <i data-lucide="aperture" size="32" color="#8e24aa"></i>
                        </div>
                        <div class="carousel-content">
                            <h3>Meditações - Chakras</h3>
                            <p>Equilíbrio dos 7 centros de energia.</p>
                        </div>
                    </a>
                </div>

                <button class="carousel-nav next" aria-label="Seguinte"><i data-lucide="chevron-right"></i></button>
            </div>
        </section>
    </main>

    <script src="script.js"></script>
    <script>
        // Initialize Icons
        lucide.createIcons();

        // Handle Mobile Logout
        const mobileLogoutBtn = document.getElementById('mobile-logout-btn');
        if (mobileLogoutBtn) {
            mobileLogoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const mainLogoutBtn = document.getElementById('logout-btn');
                if (mainLogoutBtn) mainLogoutBtn.click();
            });
        }

        // Sync User Name for Mobile Menu
        const nameDisplay = document.getElementById('user-name-display');
        const mobileNameDisplay = document.getElementById('mobile-user-name');

        // Load Saved Name
        const savedName = localStorage.getItem('userName');
        if (savedName && nameDisplay) {
            nameDisplay.textContent = savedName;
        }

        // Observer to copy name when it changes (populated by Firebase)
        const observer = new MutationObserver(() => {
            if (mobileNameDisplay) mobileNameDisplay.textContent = nameDisplay.textContent;
        });
        if (nameDisplay) {
            // Initial sync
            if (mobileNameDisplay) mobileNameDisplay.textContent = nameDisplay.textContent;
            observer.observe(nameDisplay, { childList: true, characterData: true, subtree: true });
        }
        // Carousel Navigation
        const carousel = document.querySelector('.carousel-container');
        const prevBtn = document.querySelector('.carousel-nav.prev');
        const nextBtn = document.querySelector('.carousel-nav.next');

        if (carousel && prevBtn && nextBtn) {
            prevBtn.addEventListener('click', () => {
                carousel.scrollBy({ left: -300, behavior: 'smooth' });
            });
            nextBtn.addEventListener('click', () => {
                carousel.scrollBy({ left: 300, behavior: 'smooth' });
            });
        }
    </script>

    <!-- DRAG AND DROP LOGIC FOR DASHBOARD CARDS -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('dashboard-cards-container');
            if (!container) return;

            const cards = document.querySelectorAll('.draggable-card');

            // 1. Load Saved Order from LocalStorage
            const savedOrder = localStorage.getItem('dashboardOrder');
            if (savedOrder) {
                try {
                    const order = JSON.parse(savedOrder);
                    // Append cards in the saved order
                    order.forEach(id => {
                        const card = document.getElementById(id);
                        if (card) {
                            container.appendChild(card);
                        }
                    });
                } catch (e) {
                    console.error("Error loading dashboard order", e);
                }
            }

            // 2. Setup Drag Events
            cards.forEach(card => {
                card.addEventListener('dragstart', () => {
                    card.classList.add('dragging');
                });

                card.addEventListener('dragend', () => {
                    card.classList.remove('dragging');
                    saveOrder();
                });
            });

            // 3. Setup Drop Zone (Container)
            container.addEventListener('dragover', e => {
                e.preventDefault(); // Enable Drop
                const afterElement = getDragAfterElement(container, e.clientY);
                const draggable = document.querySelector('.dragging');
                if (draggable) {
                    if (afterElement == null) {
                        container.appendChild(draggable);
                    } else {
                        container.insertBefore(draggable, afterElement);
                    }
                }
            });

            // Helper: Find position
            function getDragAfterElement(container, y) {
                const draggableElements = [...container.querySelectorAll('.draggable-card:not(.dragging)')];

                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = y - box.top - box.height / 2;
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            }

            // Helper: Save Order
            function saveOrder() {
                const currentOrder = [...container.querySelectorAll('.draggable-card')].map(card => card.id);
                localStorage.setItem('dashboardOrder', JSON.stringify(currentOrder));
                console.log("Dashboard order saved:", currentOrder);
            }
        });
    </script>

    <footer class="footer footer-centered">
        <div class="container">
            <p class="copyright">&copy; 2026 Floresce Terapias. Todos os direitos reservados.</p>
            <p class="developer-credit">CREATED IN PORTUGAL WITH ❤️ BY CALB</p>
        </div>
    </footer>

    <!-- Firebase Compat SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="init-firebase.js?v=2"></script>

    <!-- CMS Logic -->
    <script src="cms.js?v=3"></script>
    <script>
        // Initialize CMS
        if (window.initCMS) {
            window.initCMS();
        }

        // Tab Switching Logic (Global) - Legacy support if needed, but we use Accordions now
        window.openSection = function (sectionId) {
            // With accordion, we might want to just open the relevant detail
            // For now, this old function can just return or log
            console.log("Opening section:", sectionId);
        }
    </script>

    <script>
        // Protect Route & Auth Logic
        const localUser = localStorage.getItem('userEmail');

        if (!localUser) {
            if (window.auth) {
                auth.onAuthStateChanged(async (user) => {
                    if (!user) {
                        window.location.href = 'login.html';
                    } else {
                        localStorage.setItem('userEmail', user.email);
                        localStorage.setItem('isMember', 'true');

                        let finalName = user.displayName;
                        if (!finalName) {
                            try {
                                const userDocRef = doc(db, "users", user.email);
                                const userDocSnap = await getDoc(userDocRef);
                                if (userDocSnap.exists()) finalName = userDocSnap.data().name;
                            } catch (e) { }
                        }
                        if (!finalName) finalName = user.email.split('@')[0];

                        localStorage.setItem('userName', finalName);
                        updateUserDisplay(finalName);
                    }
                });
            } else {
                window.location.href = 'login.html';
            }
        } else {
            // Re-verify in background
            if (window.auth) {
                auth.onAuthStateChanged(async (user) => {
                    if (user && user.email !== localUser) {
                        localStorage.setItem('userEmail', user.email);
                    }
                });
            }
            updateUserDisplay(localStorage.getItem('userName') || 'Visitante');
        }

        function updateUserDisplay(name) {
            const nameDisplay = document.getElementById('user-name-display');
            const mobileNameDisplay = document.getElementById('mobile-user-name');
            if (nameDisplay) nameDisplay.textContent = name;
            if (mobileNameDisplay) mobileNameDisplay.textContent = name;
        }

        // Logout
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (window.auth) auth.signOut();
                localStorage.clear();
                window.location.href = 'index.html';
            });
        }

    </script>
</body>

</html>